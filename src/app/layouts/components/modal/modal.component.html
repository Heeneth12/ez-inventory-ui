<ng-container *ngIf="isOpen">

  <!-- Backdrop -->
  <div 
    class="fixed inset-0 bg-slate-900/50 backdrop-blur-sm z-50 transition-opacity duration-300"
    [class.opacity-100]="isOpen"
    [class.opacity-0]="!isOpen"
    [class.pointer-events-auto]="isOpen"
    [class.pointer-events-none]="!isOpen"
    (click)="close()">
  </div>

  <!-- Modal Panel Wrapper -->
  <div class="fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none">

    <div
      class="bg-white rounded-xl shadow-2xl w-full transform transition-all duration-300 ease-[cubic-bezier(0.34,1.56,0.64,1)] pointer-events-auto flex flex-col max-h-[90vh]"
      [class.scale-100]="isOpen"
      [class.opacity-100]="isOpen"
      [class.scale-95]="!isOpen"
      [class.opacity-0]="!isOpen"
      
      [class.max-w-sm]="size === 'sm'"
      [class.max-w-lg]="size === 'md'"
      [class.max-w-4xl]="size === 'lg'"
      [class.max-w-7xl]="size === 'xl'"
      [class.h-[95vh]]="size === 'full'"
      [class.w-full]="size === 'full'"
      [class.m-4]="size === 'full'">

      <!--Template Mode -->
      @if (template) {
        <ng-container
          *ngTemplateOutlet="template; context: context">
        </ng-container>
      }

      <!--Component Mode -->
      @if (!template) {
        <ng-container #dynamicContainer></ng-container>
      }

    </div>
  </div>
</ng-container>